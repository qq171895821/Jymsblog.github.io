(window.webpackJsonp=window.webpackJsonp||[]).push([[29],{619:function(t,s,o){"use strict";o.r(s);var r=o(0),i=Object(r.a)({},(function(){var t=this,s=t.$createElement,o=t._self._c||s;return o("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[o("div",{staticClass:"custom-block tip"},[o("p",[t._v("dy-xgorgon算法分析查找过程")])]),t._v(" "),o("h2",{attrs:{id:"dy-xgorgon算法分析查找过程"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#dy-xgorgon算法分析查找过程"}},[t._v("#")]),t._v(" dy-xgorgon算法分析查找过程")]),t._v(" "),o("h6",{attrs:{id:"此文章仅就xgorgon的分析进行介绍-思路比较简单。"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#此文章仅就xgorgon的分析进行介绍-思路比较简单。"}},[t._v("#")]),t._v(" 此文章仅就xgorgon的分析进行介绍，思路比较简单。")]),t._v(" "),o("p",[t._v("此次分析采用的抖音6.8.0版本，生成的xgorgon为03版本，经测试仍然可用。(貌似03、04都没什么关系，只要用对应版本的抖音抓出来的接口都是可以使用的。)")]),t._v(" "),o("p",[t._v("不多bb，首先直接把apk问题拖入jadx中，直接搜索X-Gorgon，点击进入第三个")]),t._v(" "),o("p",[o("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/JJymsWorld/Jymscloudiimmgg@main/img/20210621222913.png",alt:""}})]),t._v(" "),o("p",[t._v('进入之后往上可以看到一个init_gorgon函数，以及下面的hashMap.put("X-Gorgon")，可以确定此处即为生成xgorgon的地方。')]),t._v(" "),o("p",[o("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/JJymsWorld/Jymscloudiimmgg@main/img/20210621223034.png",alt:""}})]),t._v(" "),o("p",[o("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/JJymsWorld/Jymscloudiimmgg@main/img/20210621223120.png",alt:""}})]),t._v(" "),o("p",[t._v("其中X-Khronos参数为时间戳，X-Pods不用管，没有用。")]),t._v(" "),o("p",[t._v("下面分析xgorgon参数，通过分析init_gorgon中的代码可知主要有四个参数进行加密运算得到，其中四个参数分别为")]),t._v(" "),o("ul",[o("li",[t._v("请求的url")]),t._v(" "),o("li",[t._v("X-SS-STUB")]),t._v(" "),o("li",[t._v("cookie")]),t._v(" "),o("li",[t._v("sessionId")])]),t._v(" "),o("p",[t._v("如果上述参数为空则使用00000000000000000000000000000000替换，最后仍然参与运算。")]),t._v(" "),o("p",[t._v("其中X-SS-STUB的计算简单介绍一下，一般请求的X-SS-STUB即为请求体部分改造成如下样式在进行MD5加密即可")]),t._v(" "),o("p",[t._v("比如：构造的请求体部分")]),t._v(" "),o("p",[o("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/JJymsWorld/Jymscloudiimmgg@main/img/20210621223906.png",alt:""}})]),t._v(" "),o("p",[t._v("处理成："),o("code",[t._v("keyword=123&offset=0&count=10&is_pull_refresh=0&search_source=search_history&hot_search=0&latitude=30.311714&longitude=120.395521&search_id=&query_correct_type=1")]),t._v("再进行MD5的加密即为所求值。")]),t._v(" "),o("p",[t._v("下面最重要的来了，xgrogon的生成")]),t._v(" "),o("p",[o("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/JJymsWorld/Jymscloudiimmgg@main/img/20210621224046.png",alt:""}})]),t._v(" "),o("p",[t._v("如图所示，其中参数相加部分仿造其代码写一份即可，重点是"),o("code",[t._v("leviathan")]),t._v("函数，此函数实现在native层，在libcms.so文件中，使用IDA分析发现，其代码进行了OLLVM混淆，比较复杂，这里就不多进行讲解。")]),t._v(" "),o("p",[o("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/JJymsWorld/Jymscloudiimmgg@main/img/20210621224214.png",alt:""}})]),t._v(" "),o("p",[t._v("简单的实现方式是可以通过hook的方式获取到正确的xgorgon。hook框架有很多，比如Xposed，frida等。笔者用上述两种框架都尝试过，均可以正确获取到可用xgorgon，为了方便起见，笔者自己实现了一下。")]),t._v(" "),o("p",[o("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/JJymsWorld/Jymscloudiimmgg@main/img/20210621224913.png",alt:""}})]),t._v(" "),o("p",[o("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/JJymsWorld/Jymscloudiimmgg@main/img/20210621225755.png",alt:""}})]),t._v(" "),o("p",[t._v("可以看到上面箭头所指是获取到的xgorgon和xkhronos")]),t._v(" "),o("p",[t._v("下面则是请求获取到的数据，证明可用。")]),t._v(" "),o("p",[t._v("这次分享就到这里，这里只是简单分享下思路，具体实现可以自行研究尝试。有问题可咨询JJJJym@outlook.com")]),t._v(" "),o("p",[t._v("后续还会分享设备注册device_register和Xlog等算法的分析思路可以关注一下，讨论交流可直接联系我。")]),t._v(" "),o("h2",{attrs:{id:"声明"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#声明"}},[t._v("#")]),t._v(" 声明")]),t._v(" "),o("ol",[o("li",[t._v("本人纯粹技术爱好者，如若有侵犯抖音权益，请立即告知，立刻删除。")]),t._v(" "),o("li",[t._v("原创文章，禁止转载")]),t._v(" "),o("li",[t._v("请勿使用本技术用于非法行为。")])])])}),[],!1,null,null,null);s.default=i.exports}}]);